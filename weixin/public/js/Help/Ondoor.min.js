(function(n){n.fn.tab=function(t){function e(){for(var t,n=0,e=u.length;n<e;n++)if(u.eq(n).hasClass(i.navCurrentClass)){r=n;t=f.eq(r);t.hasClass(i.contentCurrentClass)||t.addClass(i.contentCurrentClass);break}r===-1&&(r=0,u.eq(r).addClass(i.navCurrentClass),f.eq(r).addClass(i.contentCurrentClass))}function o(){for(var t,e,o=location.hash.substring(1),n=0,s=u.length;n<s;n++)if(u.eq(n).data("hash")===o){r=n;t=u.eq(r);e=f.eq(r);t.hasClass(i.navCurrentClass)||(u.removeClass(i.navCurrentClass),t.addClass(i.navCurrentClass));e.hasClass(i.contentCurrentClass)||(f.removeClass(i.contentCurrentClass),e.addClass(i.contentCurrentClass));break}}var i=n.extend({},n.fn.tab.defaults,t),u=this.find(i.navSelector),f=this.find(i.contentSelector),r=-1;i.isHash?(o(),r===-1&&(e(),location.hash=u.eq(r).data("hash"))):e();this.on("click",i.navClickSelector,function(){var e=n(this).closest(i.navSelector),t=e.index();if(t===r)return this;i.isHash&&(location.hash=u.eq(t).data("hash"));u.eq(r).removeClass(i.navCurrentClass).end().eq(t).addClass(i.navCurrentClass);f.eq(r).removeClass(i.contentCurrentClass).end().eq(t).addClass(i.contentCurrentClass);r=t});return this};n.fn.tab.defaults={isHash:!1,navSelector:"li.metro-line",navClickSelector:"li.metro-line>span",contentSelector:"ul.metro-site-list",navCurrentClass:"current",contentCurrentClass:"current"}})(jQuery);jQuery(function(n){var f=n("body"),a=f.css("position"),r=n("#js-shop-city-current"),b=r.data("id"),u=n("#js-shop-city-list-wrap"),e=!1,i,w;r.on("click",function(){e=e?!1:!0;r.toggleClass("active");u.toggleClass("show");f.css("position",e?"fixed":a)});u.on("click",function(t){r.removeClass("active");u.removeClass("show");f.css("position",a);n(t.target).closest("li",u.selector).hasClass("active")&&t.preventDefault()});n("#js-metro-line-list").tab();n("#ondoor").tab({isHash:!0,navSelector:"ul.ondoor-nav>li",navClickSelector:"ul.ondoor-nav>li",contentSelector:".door,.metro",contentCurrentClass:"show"});var o=n(window),s=n("#ondoor"),v=s.find(".header"),y=s.find(".ondoor-nav"),p=n("#js-map");p.css("height",o.height()-v.outerHeight(!0)-y.outerHeight(!0));o.on("resize",function(){setTimeout(function(){p.css("height",o.height()-v.outerHeight(!0)-y.outerHeight(!0))},300)});var t=new BMap.Map("js-map"),h=ondoorAreas[s.data("cityId")],c=h.polygons,l=h.circles;if(t.centerAndZoom(h.cityName,ondoorAreas.zoom),t.addControl(new BMap.NavigationControl),t.addControl(new BMap.ScaleControl),t.enableScrollWheelZoom(),c)for(i=c.length;i--;)t.addOverlay(c[i]);if(l)for(i=l.length;i--;)t.addOverlay(l[i]);navigator.geolocation&&navigator.geolocation.getCurrentPosition&&navigator.geolocation.getCurrentPosition(function(n){t.addOverlay(new BMap.Marker(new BMap.Point(n.coords.longitude,n.coords.latitude)))});w=new BMap.LocalSearch(t,{renderOptions:{map:t,panel:"r-result"}});n("#js-map-search").on("submit",function(t){t.preventDefault();w.search(n(this).find("input").val())})});
//# sourceMappingURL=ondoor.min.js.map
